import{O as G,J,r as x,j as e,B as j,Q as z,S as E,U as X,l as V,V as Q}from"./index-B48lV-nK.js";import{P as A}from"./PageLayout-DEQp0zPa.js";import{I as R,S as U,T as f}from"./SelectField-DsoJQFOr.js";const B=[{id:1,name:"Access Business Group International BV",code:"ABG",state:"Active",modules:["BoM","REACH"],regions:["EU","UK"],brands:1,users:3,type:"External access",services:{}},{id:2,name:"Aloxxi",code:"ALO",state:"Active",modules:["Analyse","BoM","CPSR (view)","PIF"],regions:["EU","UK"],brands:9,users:0,type:"External access",services:{}},{id:3,name:"Always Summer Limited",code:"ASL",state:"Active",modules:["Analyse","BoM","CPSR (view)","PIF"],regions:["EU"],brands:1,users:0,type:"External access",services:{}},{id:4,name:"Apex Laboratories Private",code:"APEX",state:"Active",modules:["BoM"],regions:["EU"],brands:0,users:0,type:"External access",services:{}},{id:5,name:"Australian Gold",code:"AUGO",state:"Active",modules:["BoM","REACH"],regions:["EU","UK"],brands:2,users:0,type:"External access",services:{}},{id:6,name:"AX Beauty Brands Global LLC",code:"AXB",state:"Active",modules:["Analyse","BoM","CPSR (view)","PIF"],regions:["EU","UK"],brands:1,users:0,type:"External access",services:{}},{id:7,name:"Ayu Cosmetics",code:"AYU",state:"Active",modules:["BoM","PIF"],regions:["EU"],brands:1,users:0,type:"External access",services:{}},{id:8,name:"Beauty Brands Inc",code:"BBE",state:"Inactive",modules:["BoM"],regions:["EU"],brands:0,users:0,type:"External access",services:{}},{id:9,name:"Cosmetic Solutions Ltd",code:"CSL",state:"Active",modules:["Analyse","BoM","PIF"],regions:["EU","UK","US"],brands:5,users:2,type:"External access",services:{}},{id:10,name:"Derma Care International",code:"DCI",state:"Active",modules:["BoM","REACH"],regions:["EU"],brands:3,users:1,type:"External access",services:{}}],Y=d=>{let c=localStorage.getItem("prims_clients"),r=c?JSON.parse(c):[];return r.length===0&&(localStorage.setItem("prims_clients",JSON.stringify(B)),r=B),r.find(h=>h.id===Number(d))||null},I=[{value:"EU",label:"EU (European Union)"},{value:"UK",label:"UK (United Kingdom)"},{value:"USA",label:"USA (United States)"},{value:"Canada",label:"Canada"}],P=["EU","UK","USA","Canada"],y=[{value:"none",label:"Not Enabled"},{value:"safety",label:"Safety Assessment"},{value:"responsible",label:"Responsible Person"},{value:"all-in",label:"All-In (Safety + Responsible)"}],u=[{id:"bom",name:"BoM",description:"Bill of Materials management. Minimum requirement for every client.",hierarchyLabel:"Hierarchy Level: Base (Required)",required:!0,dependencies:[]},{id:"bom-import",name:"BoM (import)",description:"Enables bulk BoM imports from external files.",requiresLabel:"Requires: BoM module",dependencies:["bom"]},{id:"pif",name:"PIF",description:"Product Information File completeness tool with document downloads.",hierarchyLabel:"Hierarchy Level: 2 (includes BoM)",dependencies:["bom"]},{id:"analyse",name:"Analyse",description:"Safety and compliance assessment tools.",hierarchyLabel:"Hierarchy Level: 3 (includes BoM, PIF)",dependencies:["pif"]},{id:"cpsr-view",name:"CPSR (view)",description:"View and download Cosmetic Product Safety Reports prepared by TRC.",hierarchyLabel:"Hierarchy Level: 4 (includes BoM, PIF, Analyse)",dependencies:["analyse"]},{id:"cpsr-edit",name:"CPSR (edit)",description:"Create and edit Cosmetic Product Safety Reports.",requiresLabel:"Requires: CPSR (view) module",dependencies:["cpsr-view"]},{id:"document-upload",name:"Document Upload",description:"Exchange documents with TRC through the platform.",statusLabel:"Status: In Development",dependencies:[]},{id:"reach",name:"REACH",description:"REACH compliance reporting tool for substance registration.",requiresLabel:"Requires: BoM module (independent add-on)",dependencies:["bom"]},{id:"retailer-client",name:"Retailer Restrictions (client)",description:"Create and manage custom clean beauty restriction lists.",typeLabel:"Type: Independent add-on",dependencies:[]},{id:"retailer-trc",name:"Retailer Restrictions (TRC)",description:"Access clean beauty restriction lists maintained by TRC.",typeLabel:"Type: Independent add-on",dependencies:[]}],W=u.reduce((d,c)=>(d[c.name]=c.id,d),{}),L=u.reduce((d,c)=>(d[c.id]=c.name,d),{});function ae(){const{id:d}=G(),c=J(),[r,h]=x.useState("services"),[n,Z]=x.useState(()=>Y(d)),[b,M]=x.useState({name:(n==null?void 0:n.name)||"",code:(n==null?void 0:n.code)||"",type:(n==null?void 0:n.type)||"External access"}),w=s=>{if(!s)return"none";if(typeof s=="string")return y.some(l=>l.value===s)?s:"none";const a=s.safetyAssessment==="yes",i=s.responsiblePerson==="yes";return s.allIn==="yes"||a&&i?"all-in":a?"safety":i?"responsible":"none"},[g,q]=x.useState(()=>{const s={};return P.forEach(a=>{var i;s[a]=w((i=n==null?void 0:n.services)==null?void 0:i[a])}),s}),[p,C]=x.useState(()=>{const s=new Set,a=((n==null?void 0:n.modules)||[]).map(i=>W[i]).filter(Boolean);return u.forEach(i=>{i.required&&s.add(i.id)}),a.forEach(i=>s.add(i)),s}),[S,F]=x.useState(()=>{const s=new Set((n==null?void 0:n.regions)||[]);return s.add("EU"),s}),N=[{value:"External access",label:"External access"},{value:"Internal",label:"Internal"},{value:"Partner",label:"Partner"}];if(!n)return e.jsx(A,{title:"Client Not Found",children:e.jsxs("div",{style:{padding:"2rem",textAlign:"center"},children:[e.jsx("p",{children:"Client not found. Please go back to the clients list."}),e.jsx(j,{icon:e.jsx(z,{}),variant:"btn-primary",onClick:()=>c("/admin/clients"),children:"Back to Clients"})]})});const _=(s,a)=>{M(i=>({...i,[s]:a}))},k=(s,a)=>{q(i=>({...i,[s]:a}))},T=s=>{const a=u.find(l=>l.id===s);if(!a)return;if(p.has(s)){if(a.required){f.info(`${a.name} is required and cannot be disabled.`);return}const l=new Set,o=v=>{l.add(v),u.forEach(t=>{t.dependencies.includes(v)&&p.has(t.id)&&o(t.id)})};o(s),C(v=>{const t=new Set(v);return l.forEach(K=>t.delete(K)),t});return}const m=a.dependencies.filter(l=>!p.has(l));if(m.length>0){const l=m.map(o=>L[o]||o).join(", ");f.info(`Enable ${l} before turning on ${a.name}.`);return}C(l=>{const o=new Set(l);return o.add(s),o})},$=s=>{s!=="EU"&&F(a=>{const i=new Set(a);return i.has(s)?i.delete(s):i.add(s),i})},O=()=>{const s=u.filter(t=>p.has(t.id)).map(t=>t.name),i=["EU","UK","USA","Canada"].filter(t=>S.has(t)),m={...n,...b,services:g,modules:s,regions:i},l=localStorage.getItem("prims_clients"),v=(l?JSON.parse(l):[]).map(t=>t.id===n.id?m:t);localStorage.setItem("prims_clients",JSON.stringify(v)),f.success("Client details saved successfully!")},D=()=>{c("/admin/clients")},H=P;return e.jsxs(A,{title:n.name,headerActions:e.jsxs(e.Fragment,{children:[e.jsx(j,{icon:e.jsx(V,{}),variant:"btn-secondary",onClick:D,children:"Cancel"}),e.jsx(j,{icon:e.jsx(Q,{}),variant:"btn-primary",onClick:O,children:"Save Changes"})]}),children:[e.jsxs("div",{className:"client-details__info",children:[e.jsxs("div",{className:"client-details__info-header",children:[e.jsx("h3",{children:"Client Information"}),e.jsx("p",{className:"client-details__info-description",children:"Primary client details and identification"})]}),e.jsxs("div",{className:"client-details__info-fields",children:[e.jsxs("div",{className:"client-details__info-field",children:[e.jsx("label",{children:"Name"}),e.jsx(R,{value:b.name,onChange:s=>_("name",s),placeholder:"Client name"})]}),e.jsxs("div",{className:"client-details__info-field",children:[e.jsx("label",{children:"Code"}),e.jsx(R,{value:b.code,onChange:s=>_("code",s),placeholder:"Client code"})]}),e.jsxs("div",{className:"client-details__info-field",children:[e.jsx("label",{children:"Type"}),e.jsx(U,{value:N.find(s=>s.value===b.type),onChange:s=>_("type",(s==null?void 0:s.value)||""),options:N,placeholder:"Select type"})]})]})]}),e.jsxs("div",{className:"client-details__tabs",children:[e.jsxs("div",{className:"client-details__tab-list",children:[e.jsx("button",{className:`client-details__tab ${r==="services"?"is-active":""}`,onClick:()=>h("services"),children:"Services"}),e.jsx("button",{className:`client-details__tab ${r==="modules"?"is-active":""}`,onClick:()=>h("modules"),children:"Modules & Regions"}),e.jsx("button",{className:`client-details__tab ${r==="permissions"?"is-active":""}`,onClick:()=>h("permissions"),children:"Permissions Matrix"}),e.jsx("button",{className:`client-details__tab ${r==="users"?"is-active":""}`,onClick:()=>h("users"),children:"Users"})]}),e.jsxs("div",{className:"client-details__tab-content",children:[r==="services"&&e.jsxs("div",{className:"client-details__services",children:[e.jsxs("div",{className:"client-details__services-header",children:[e.jsx("h4",{children:"Available Services"}),e.jsx("p",{className:"client-details__services-description",children:"Configure services per region for this client"})]}),e.jsx("div",{className:"client-details__services-table",children:e.jsxs("table",{className:"services-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Region"}),e.jsx("th",{children:"Service Offering"})]})}),e.jsx("tbody",{children:H.map(s=>{var a;return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("span",{className:"services-table__region",children:((a=I.find(i=>i.value===s))==null?void 0:a.label)||s})}),e.jsx("td",{children:e.jsx(U,{value:y.find(i=>i.value===(g[s]||"none")),onChange:i=>k(s,(i==null?void 0:i.value)||"none"),options:y,className:"services-table__select"})})]},s)})})]})})]}),r==="modules"&&e.jsxs("div",{className:"client-details__modules",children:[e.jsxs("div",{className:"module-hierarchy-card",children:[e.jsx("p",{className:"module-hierarchy-card__label",children:"Module Hierarchy"}),e.jsx("h4",{children:"BoM → PIF → Analyse → CPSR (view)"}),e.jsx("p",{children:"Each module includes all functionalities from lower hierarchy modules. REACH and Retailer Restrictions are independent add-ons."})]}),e.jsxs("div",{className:"module-note",children:[e.jsx(E,{}),e.jsx("span",{children:"BoM module is the minimum requirement for every client. Selecting a higher-level module automatically grants access to all lower-level modules in the hierarchy."})]}),e.jsx("div",{className:"module-card-grid",children:u.map(s=>{const a=p.has(s.id),i=s.dependencies.every(l=>p.has(l)),m=!a&&!i||s.required;return e.jsxs("article",{className:`module-card ${a?"is-selected":""}`,children:[e.jsxs("div",{className:"module-card__header",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"module-card__title-row",children:[e.jsx("h5",{children:s.name}),s.required&&e.jsx("span",{className:"module-card__badge module-card__badge--required",children:"Required"})]}),e.jsx("p",{className:"module-card__description",children:s.description})]}),e.jsx("button",{className:`module-card__toggle ${a?"is-on":""}`,onClick:()=>T(s.id),disabled:m,"aria-pressed":a,"aria-label":a?`Disable ${s.name}`:`Enable ${s.name}`,title:s.required?`${s.name} is required`:!a&&!i?`Requires ${s.dependencies.map(l=>L[l]).join(", ")}`:void 0,children:e.jsx("span",{className:"module-card__toggle-track",children:e.jsx("span",{className:"module-card__toggle-thumb"})})})]}),e.jsxs("div",{className:"module-card__meta",children:[s.hierarchyLabel&&e.jsx("span",{className:"module-card__pill",children:s.hierarchyLabel}),s.requiresLabel&&e.jsx("span",{className:"module-card__pill",children:s.requiresLabel}),s.statusLabel&&e.jsx("span",{className:"module-card__pill module-card__pill--status",children:s.statusLabel}),s.typeLabel&&e.jsx("span",{className:"module-card__pill module-card__pill--type",children:s.typeLabel})]})]},s.id)})}),e.jsxs("div",{className:"client-details__regions",children:[e.jsxs("div",{className:"client-details__regions-header",children:[e.jsx("h4",{children:"Available Regions"}),e.jsxs("div",{className:"client-details__regions-note",children:[e.jsx(E,{}),e.jsx("span",{children:"EU is the default region for all clients. Enable additional regions as needed."})]})]}),e.jsx("div",{className:"client-details__region-grid",children:I.map(s=>{const a=S.has(s.value);return e.jsxs("button",{type:"button",className:`region-pill ${a?"is-active":""}`,onClick:()=>$(s.value),disabled:s.value==="EU",children:[e.jsx("span",{className:"region-pill__checkbox",children:a&&e.jsx(X,{})}),e.jsxs("span",{className:"region-pill__label",children:[s.label,s.value==="EU"&&" - Default"]})]},s.value)})})]})]}),r==="permissions"&&e.jsx("div",{className:"client-details__permissions",children:e.jsx("p",{children:"Permissions Matrix will be implemented here."})}),r==="users"&&e.jsx("div",{className:"client-details__users",children:e.jsx("p",{children:"Users management will be implemented here."})})]})]})]})}export{ae as default};
